# System Call


정의
<br>
자원이 필요한 프로세스가 하드웨어를 직접적으로 관리하는 OS에게 자원을 요청할 때 사용하는 인터페이스


### 커널
운영체제의 핵심 기능만 모아놓은 것이 커널이다.

#### 커널의 구성
- 프로세스 관리 : 프로세스에 CPU를 분배하고 작업에 필요한 제반 환경을 제공 <br>
- 메모리 관리 : 프로세스에 작업 공간을 배치하고 실제 메모리보다 큰 가상공간 제공
- 파일 시스템 관리 : 데이터 저장하고 접근할 수 있는 인터페이스 제공
- 입출력 관리 : 필요한 입출력 서비스 제공
- 프로세스 간 통신 관리 : 공동 작업을 위한 각 프로세스 간 통신 환경 제공

#### 단일형 구조 커널

초창기의 운영체제 구조로, 커널의 핵심 기능을 구현하는 모듈들이 구분 없이 하나로 구성되어 있다.

- 장점 : 모듈들이 거의 분리되지 않았기 때문에 모듈 간의 통신 비용이 줄어들어 효율적인 운영 가능
- 단점
    - 모든 모듈들이 하나로 묶여 있기 때문에 버그나 오류 처리가 쉽지 않다.
    - 여러 기능이 서로 연결되어 있어 상호 의존성이 높기 때문에 기능상 작은 결함이 시스템 전체 성능 문제 야기

<br>

#### 계층형 구조 터널
단일형 구조 커널이 발전된 형태, 비슷한 기능을 가진 모듈들을 묶어서 하나의 계층으로 만들고 계층 간에 통신을 통해 운영체제를 구현하는 방식

- 장점
    - 비슷한 기능들을 모두 모듈화했기 때문에 단일형 구조보다 버그나 오류를 쉽게 수정가능 하고 디버깅도 수월하다.

### 인터페이스
커널에 사용자의 명령을 전달하고 실행 결과를 사용자에게 알려주는 역할
<br>
운영체제의 핵심 기능인 커널에 접근하기 위해서 필요한 것이 인터페이스

### System Call
프로세스가 커널 영역의 기능을 사용자 모드가 가용 가능하게, 즉 하드웨어에 직접 접근해서 필요한 기능을 할 수 있게 해준다.
<br>
보통 직접적으로 시스템 콜을 사용하기 보다는 API(라이브러리 함수)를 통해 사용하게 된다.

#### 시스템 콜의 종류
- 프로세스 제어
    - exit, abort, load, execute, for ...
- 파일 조작
    - create, delete, open, close, read, write, ...
- 장치 관리
    - ioctl, request device, release device, ...
- 정보 유지
    - getpid, alarm, sleep, ...
- 통신
    - pipe. shm_open, mmap, ...
- 보호
    - chmod, umask, chown, ...

### CPU 모드
CPU는 사용자 어플리케이션이 시스템을 손상시키는 것을 방지하기 위해 2가지 모드를 제공한다. <br>
CPU에 있는 Mode bit로 모드를 구분 <br>
0은 커널모드, 1은 사용자 모드로 나뉘어서 구동된다.
<br>

#### 사용자 모드
사용자 어플리케이션 코드가 실행된다.<br>
사용자가 접근할 수 없는 영역(대표적으로 하드웨어)에 접근하기 위해서 시스템 콜을 사용해야 한다.

#### 커널 모드
운영체제가 CPU를 사용하는 모드이다. <br>
시스템 콜을 통해 커널 모드로 전환이 되면 운영체제는 하드웨어를 제어하는 명령어(Privileged Instructions)를 실행한다.<br>
Privileged Instructions는 사용자 모드에서 실행되면 접근을 할 수 없기 때문에 예외가 발생한다.

<br>
<br>

reference <br>
https://brightstarit.tistory.com/13 <br>
https://didu-story.tistory.com/311

